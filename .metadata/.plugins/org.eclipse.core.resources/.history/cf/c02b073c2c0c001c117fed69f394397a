package br.com.lollabe.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;

import br.com.lollabe.model.Produto;


public class FotoDAO {

	public Boolean inserir(Produto produto)
    {
        Boolean retorno = false;
        String sql = "INSERT INTO produto (foto) values (?)";
        
        PreparedStatement pst = Conexao.getPreparedStatement(sql);
        try
        {
            pst.setBytes(1, produto.getFoto());
            pst.executeUpdate();
            retorno = true;
            
        }
        catch(Exception ex)
        {
            ex.printStackTrace();
        }
        
        return retorno;
    
    }
    
    public Produto buscar(Integer id)
    {
        Produto produto = null;
        String sql = "SELECT id,foto from produto where id=?";
        PreparedStatement pst = Conexao.getPreparedStatement(sql);
        
        try {
            pst.setInt(1, id);
            ResultSet rs = pst.executeQuery();
            if(rs.next())
            {
            	produto = new Produto();
            	produto.setId(rs.getLong("id"));
                produto.setFoto(rs.getBytes("imagem"));
            
            }
            
        } catch (Exception e) {
            e.printStackTrace();
            produto = null;
        }
        
        return produto;
    
    }
}
