package br.com.lollabe.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;

import org.springframework.web.bind.annotation.RestController;

import br.com.lollabe.model.Foto;
import br.com.lollabe.model.Produto;

@RestController
public class FotoDAO {

	public Boolean inserir(Foto foto)
    {
        Boolean retorno = false;
        String sql = "INSERT INTO foto (imagem) values (?)";
        
        PreparedStatement pst = Conexao.getPreparedStatement(sql);
        try
        {
            pst.setBytes(1, foto.getImagem());
            pst.executeUpdate();
            retorno = true;
            
        }
        catch(Exception ex)
        {
            ex.printStackTrace();
        }
        
        return retorno;
    
    }
    
    public Produto buscar(Integer id)
    {
        Produto produto = null;
        String sql = "SELECT id,imagem from produto where id=?";
        PreparedStatement pst = Conexao.getPreparedStatement(sql);
        
        try {
            pst.setInt(1, id);
            ResultSet rs = pst.executeQuery();
            if(rs.next())
            {
            	produto = new Produto();
            	produto.setId(rs.getLong("id"));
                produto.setFoto(rs.getBytes("imagem"));
            
            }
            
        } catch (Exception e) {
            e.printStackTrace();
            produto = null;
        }
        
        return produto;
    
    }
}
